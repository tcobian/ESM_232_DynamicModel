---
title: "Assignment#4"
author: "Tyler Cobian"
date: "5/13/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Install the packages
```{r}
library(tidyverse)
library(deSolve)
```

Input the model for forest growth
```{r}
forest<- function(initial_kgC, early_growth, later_growth, K, canopy_thresh, temp, time){

  # Set the initial size of forest
  kgC = initial_kgC
  
  # Calculate the growth rate at each time step in a for loop
  for (i in 1:time) {
    
    kgC = kgC * early_growth
    kgC = ifelse(temp < 0, 0, kgC)
    kgC = ifelse(kgC > canopy_thresh, kgC*later_growth, kgC)
    kgC = ifelse(kgC >= K, 0, kgC)
    
  }
  return(kgC)
    }
```

Save the input parameters
```{r}
initial_kgC = 10
early_growth = 0.01
later_growth = 2
K = 500
canopy_thresh = 100
temp = 20
time = 300
```

Run the ODE solver
```{r}
# set up the parms
parms = list(early_growth, later_growth, K, canopy_thresh, temp)

# Run the ODE
results = ode(initial_kgC, time, forest, parms)

```













