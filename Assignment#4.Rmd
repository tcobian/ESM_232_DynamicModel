---
title: "Assignment#4"
author: "Tyler Cobian"
date: "5/13/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Install the packages
```{r}
library(tidyverse)
library(deSolve)
```

Input the model for forest growth
```{r}
forest<- function(time, initial_kgC, parms){

  
  # define the parms
  early_growth<- parms$early_growth
  later_growth<- parms$later_growth
  K<- parms$K
  canopy_thresh<- parms$canopy_thresh
  temp<- parms$temp
  
  # Set the initial size of forest
  kgC = initial_kgC
  
  if (temp < 0) {
    kgC = 0
  } else if (kgC < canopy_thresh) {
      kgC * early_growth
  } else if (kgC > canopy_thresh) {
      kgC * later_growth
  } else (kgC >= K) {
    kgC = K
  }
  
  
#  ifelse(temp < 0, 0, kgC)
#  ifelse(kgC < canopy_thresh, kgC * early_growth, kgC)
#  ifelse(kgC > canopy_thresh, kgC * later_growth, kgC)
#  ifelse(kgC >= K, kgC, kgC)
  
  return(list(kgC))
}

```

Set up the time 
```{r}
time = seq(from=1, to=500, by=1)
```

Run the ODE solver
```{r}
# set up the parms
parms = list(early_growth = 0.01, later_growth = 2, K = 500, canopy_thresh = 100, temp = 20)

# Run the ODE
results = ode(y = initial_kgC, times = time, func = forest, parms = parms)

head(results)

plot(results)

```













