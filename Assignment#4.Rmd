---
title: "Assignment#4"
author: "Tyler Cobian"
date: "5/13/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Install the packages
```{r}
library(tidyverse)
library(deSolve)
```

Input the model for forest growth
```{r}
forest<- function(time, initial_kgC, parms){

  
  # define the parms
  early_growth<- parms$early_growth
  later_growth<- parms$later_growth
  K<- parms$K
  canopy_thresh<- parms$canopy_thresh
  temp<- parms$temp
  
  # Set the initial size of forest
  kgC = initial_kgC
  
if (kgC > canopy_thresh) return(list(kgC * early_growth))
  
if (kgC < canopy_thresh) return(list(kgC * later_growth))
  
if (kgC > K) return(list(kgC = K))
  
if (temp < 0) return(list(kgC * 0))



}

```

Set up the time and initial kgC
```{r}
time = seq(from=1, to=300, by=1)

initial_kgC = 10
```

Run the ODE solver
```{r}
# set up the parms
parms = list(early_growth = 0.01, later_growth = 2, K = 500, canopy_thresh = 100, temp = 20)

# Run the ODE
results = ode(y = initial_kgC, times = time, func = forest, parms = parms)

head(results)

# clean up the results data and save as dataframe
colnames(results)<- c("time", "kgC")
results_df = as.data.frame(unlist(results))


# plot the results of the ODE run
forest_plot<- ggplot(data = results_df, aes(x = time, y = kgC))+
  geom_line(colour = "cyan4")+
  labs(title = "Dyanmic Forest Growth")+
  theme_minimal()
forest_plot

```

Run a sensativity analysis
```{r}
# number of runs
np = 500

# make a distribution for early and later growth
early_growth = rnorm(mean = 0.01, sd = 0.001, n = np)
later_growth = rnorm(mean = 2, sd = 0.05, n = np)
```












